# Twig

## Doc
- [Go to Twig Doc](http://twig.sensiolabs.org/doc/2.x/)

### Tags
- [autoescape][1]
- [block][2]
- [do][3]
- [embed][4]
- [extends][5]
- [filter][6]
- [flush][7]
- [for][8]
- [from][9]
- [if][10] 
- [import][11]
- [include][12]
- [macro][13]
- [sandbox][14]
- [set][15]
- [spaceless][16]
- [use][17]
- [verbatim][18]
- [with][19]

### Filters
- [abs][1-1]
- [batch][1-2]
- [capitalize][1-3] 
- [convert_encoding][1-4]
- [date][1-5]
- [date_modify][1-6]
- [default][1-7]
- [escape][1-8] 
- [first][1-9] 
- [format][1-10] 
- [join][1-11] 
- [json_encode][1-12] 
- [keys][1-13] 
- [last][1-14] 
- [length][1-15] 
- [lower][1-16] 
- [merge][1-17] 
- [nl2br][1-18] 
- [number_format][1-19] 
- [raw][1-20] 
- [replace][1-21] 
- [reverse][1-22] 
- [round][1-23] 
- [slice][1-24] 
- [sort][1-25] 
- [split][1-26] 
- [striptags][1-27] 
- [title][1-28] 
- [trim][1-29] 
- [upper][1-30] 
- [url_encode][1-31] 

### Functions
- [attribute][2-1] 
- [block][2-2]
- [constant][2-3]
- [cycle][2-4]
- [date][2-5]
- [dump][2-6]
- [include][2-7]
- [max][2-8]
- [min][2-9]
- [parent][2-10]
- [random][2-11]
- [range][2-12] 
- [source][2-13] 
- [template_from_string][2-14]

### Tests
- [constant][3-1]
- [defined][3-2] 
- [divisibleby][3-3] 
- [empty][3-4] 
- [even][3-5] 
- [iterable][3-6] 
- [null][3-7] 
- [odd][3-8] 
- [sameas][3-9] 

### Operators
- [in][3-10] 
- [is][3-11] 
- [Math][3-12] 
- [Logic][3-13] 
- [Comparisons][3-14] 
- [Others][3-15] 

----------

[3-10]: http://twig.sensiolabs.org/doc/2.x/templates.html#containment-operator
[3-11]: http://twig.sensiolabs.org/doc/2.x/templates.html#test-operator
[3-12]: http://twig.sensiolabs.org/doc/2.x/templates.html#math
[3-13]: http://twig.sensiolabs.org/doc/2.x/templates.html#math
[3-14]: http://twig.sensiolabs.org/doc/2.x/templates.html#comparisons
[3-15]: http://twig.sensiolabs.org/doc/2.x/templates.html#other-operators

[3-1]: http://twig.sensiolabs.org/doc/2.x/tests/constant.html
[3-2]: http://twig.sensiolabs.org/doc/2.x/tests/defined.html
[3-3]: http://twig.sensiolabs.org/doc/2.x/tests/divisibleby.html
[3-4]: http://twig.sensiolabs.org/doc/2.x/tests/empty.html
[3-5]: http://twig.sensiolabs.org/doc/2.x/tests/even.html
[3-6]: http://twig.sensiolabs.org/doc/2.x/tests/iterable.html
[3-7]: http://twig.sensiolabs.org/doc/2.x/tests/null.html
[3-8]: http://twig.sensiolabs.org/doc/2.x/tests/odd.html
[3-9]: http://twig.sensiolabs.org/doc/2.x/tests/sameas.html

[2-1]: http://twig.sensiolabs.org/doc/2.x/functions/attribute.html
[2-2]: http://twig.sensiolabs.org/doc/2.x/functions/block.html
[2-3]: http://twig.sensiolabs.org/doc/2.x/functions/constant.html
[2-4]: http://twig.sensiolabs.org/doc/2.x/functions/cycle.html
[2-5]: http://twig.sensiolabs.org/doc/2.x/functions/date.html
[2-6]: http://twig.sensiolabs.org/doc/2.x/functions/dump.html
[2-7]: http://twig.sensiolabs.org/doc/2.x/functions/include.html
[2-8]: http://twig.sensiolabs.org/doc/2.x/functions/max.html
[2-9]: http://twig.sensiolabs.org/doc/2.x/functions/min.html
[2-10]: http://twig.sensiolabs.org/doc/2.x/functions/parent.html
[2-11]: http://twig.sensiolabs.org/doc/2.x/functions/random.html
[2-12]: http://twig.sensiolabs.org/doc/2.x/functions/range.html
[2-13]: http://twig.sensiolabs.org/doc/2.x/functions/source.html
[2-14]: http://twig.sensiolabs.org/doc/2.x/functions/template_from_string.html

[1-1]: http://twig.sensiolabs.org/doc/2.x/filters/abs.html
[1-2]: http://twig.sensiolabs.org/doc/2.x/filters/batch.html
[1-3]: http://twig.sensiolabs.org/doc/2.x/filters/capitalize.html
[1-4]: http://twig.sensiolabs.org/doc/2.x/filters/convert_encoding.html
[1-5]: http://twig.sensiolabs.org/doc/2.x/filters/date.html
[1-6]: http://twig.sensiolabs.org/doc/2.x/filters/date_modify.html
[1-7]: http://twig.sensiolabs.org/doc/2.x/filters/default.html
[1-8]: http://twig.sensiolabs.org/doc/2.x/filters/escape.html
[1-9]: http://twig.sensiolabs.org/doc/2.x/filters/first.html
[1-10]: http://twig.sensiolabs.org/doc/2.x/filters/format.html
[1-11]: http://twig.sensiolabs.org/doc/2.x/filters/join.html
[1-12]: http://twig.sensiolabs.org/doc/2.x/filters/json_encode.html
[1-13]: http://twig.sensiolabs.org/doc/2.x/filters/keys.html
[1-14]: http://twig.sensiolabs.org/doc/2.x/filters/last.html
[1-15]: http://twig.sensiolabs.org/doc/2.x/filters/length.html
[1-16]: http://twig.sensiolabs.org/doc/2.x/filters/lower.html
[1-17]: http://twig.sensiolabs.org/doc/2.x/filters/merge.html
[1-18]: http://twig.sensiolabs.org/doc/2.x/filters/nl2br.html
[1-19]: http://twig.sensiolabs.org/doc/2.x/filters/number_format.html
[1-20]: http://twig.sensiolabs.org/doc/2.x/filters/raw.html
[1-21]: http://twig.sensiolabs.org/doc/2.x/filters/replace.html
[1-22]: http://twig.sensiolabs.org/doc/2.x/filters/reverse.html
[1-23]: http://twig.sensiolabs.org/doc/2.x/filters/round.html
[1-24]: http://twig.sensiolabs.org/doc/2.x/filters/slice.html
[1-25]: http://twig.sensiolabs.org/doc/2.x/filters/sort.html
[1-26]: http://twig.sensiolabs.org/doc/2.x/filters/split.html
[1-27]: http://twig.sensiolabs.org/doc/2.x/filters/striptags.html
[1-28]: http://twig.sensiolabs.org/doc/2.x/filters/title.html
[1-29]: http://twig.sensiolabs.org/doc/2.x/filters/trim.html
[1-30]: http://twig.sensiolabs.org/doc/2.x/filters/upper.html
[1-31]: http://twig.sensiolabs.org/doc/2.x/filters/url_encode.html

[1]: http://twig.sensiolabs.org/doc/2.x/tags/autoescape.html
[2]: http://twig.sensiolabs.org/doc/2.x/tags/block.html
[3]: http://twig.sensiolabs.org/doc/2.x/tags/do.html
[4]: http://twig.sensiolabs.org/doc/2.x/tags/embed.html
[5]: http://twig.sensiolabs.org/doc/2.x/tags/extends.html
[6]: http://twig.sensiolabs.org/doc/2.x/tags/filter.html
[7]: http://twig.sensiolabs.org/doc/2.x/tags/flush.html
[8]: http://twig.sensiolabs.org/doc/2.x/tags/for.html
[9]: http://twig.sensiolabs.org/doc/2.x/tags/from.html
[10]: http://twig.sensiolabs.org/doc/2.x/tags/if.html
[11]: http://twig.sensiolabs.org/doc/2.x/tags/import.html
[12]: http://twig.sensiolabs.org/doc/2.x/tags/include.html
[13]: http://twig.sensiolabs.org/doc/2.x/tags/macro.html
[14]: http://twig.sensiolabs.org/doc/2.x/tags/sandbox.html
[15]: http://twig.sensiolabs.org/doc/2.x/tags/set.html
[16]: http://twig.sensiolabs.org/doc/2.x/tags/spaceless.html
[17]: http://twig.sensiolabs.org/doc/2.x/tags/use.html
[18]: http://twig.sensiolabs.org/doc/2.x/tags/verbatim.html
[19]: http://twig.sensiolabs.org/doc/2.x/tags/with.html



## Best Practice 
- [Global Variables](#global-variables)
- [Dump variable](#dump-variable)
- [The ternary operator](#the-ternary-operator)
- [String Interpolation](#string-interpolation)
- [Control Structure](#control-structure)
- [Use the loop variable](#use-the-loop-variable)
- [Use EMBED](#use-embed)
- [Use Import and Macros](#use-import-and-macros)
- [Add new extensions](#add-new-extensions)

### Global Variables

* **_self**: references the current template name;
* **_context**: references the current context;
* **_charset**: references the current charset.

###  Dump variable
```php
{{ dump(_context) }}
```

### The ternary operator
```php
{{ foo ? 'yes' : 'no' }}
{{ foo ?: 'no' }} is the same as {{ foo ? foo : 'no' }}
{{ foo ? 'yes' }} is the same as {{ foo ? 'yes' : '' }}

{# returns the value of foo if it is defined and not null, 'no' otherwise #}
{{ foo ?? 'no' }}
```

### String Interpolation
```php
{{ "foo #{bar} baz" }}
{{ "foo #{1 + 2} baz" }}
```

### Control Structure
```php
{% if users|length > 0 %}
    <ul>
        {% for user in users %}
            <li>{{ user.username|e }}</li>
        {% endfor %}
    </ul>
{% endif %}

{# or #}

<ul>
    {% for user in users %}
        <li>{{ user.username|e }}</li>
    {% else %}
        <li>no user found</li>
    {% endfor %}
</ul>
```

```php
{% if title %}
    <h1>{{ title }</h1>}
{% endif %}
```

### Use the loop variable
| Variable | Description |
| - | - |
| loop.index | The current iteration of the loop. (1 indexed) |
| loop.index0 | The current iteration of the loop. (0 indexed) |
| loop.revindex | The number of iterations from the end of the loop (1 indexed) |
| loop.revindex0 | The number of iterations from the end of the loop (0 indexed) |
| loop.first | True if first iteration |
| loop.last | True if last iteration |
| loop.length | The number of items in the sequence |
| loop.parent | The parent context |


### Use EMBED
The embed tag combines the behaviour of include and extends. It allows you to include another template's contents, just like include does. But it also allows you to override any block defined inside the included template, like when extending a template.

Think of an embedded template as a "micro layout skeleton".

#### Example

Create module: `modal.html.twig`
```php
<div class="Modal" id="{{ "Modal-#{id}" }}">
    <div class="Modal-content">
        <div class="Modal-header">
            {% block header %}
                Modal header default content
            {% endblock %}
        </div>
        <div class="Modal-body">
            {% block body %}
                Modal body default content
            {% endblock %}
        </div>
    </div>
</div>
```

Usage: `template.html.twig`
```php
{% embed "modal.html.twig" with { 'id' : 1} %}
    {% block header %}
        Some content for the modal heade
    {% endblock %}

    {% block body %}
        Some content for the modal body
    {% endblock %}
{% endembed %}
```

[More informations][4]

### Use Import and Macros

`form.html.twig`
```php
{% macro input(name, value, type, size) %}
    <input type="{{ type|default('text') }}" name="{{ name }}" value="{{ value|e }}" size="{{ size|default(20) }}" />
{% endmacro %}

{% macro textarea(name, value, rows, cols) %}
    <textarea name="{{ name }}" rows="{{ rows|default(10) }}" cols="{{ cols|default(40) }}">{{ value|e }}</textarea>
{% endmacro %}
```

Usage: `template.html.twig`
```php
{% import 'forms.html.twig' as forms %}

<dl>
    <dt>Username</dt>
    <dd>{{ forms.input('username') }}</dd>
    <dt>Password</dt>
    <dd>{{ forms.input('password', null, 'password') }}</dd>
</dl>
<p>{{ forms.textarea('comment') }}</p>

{# or #}

{% from 'forms.html' import input as input_field, textarea %}

<dl>
    <dt>Username</dt>
    <dd>{{ input_field('username') }}</dd>
    <dt>Password</dt>
    <dd>{{ input_field('password', '', 'password') }}</dd>
</dl>
<p>{{ textarea('comment') }}</p>
```

More informations [import][11] and [macro][13] 

### Add new extensions

#### Create
`src/AppBundle/Twig/AppExtension.php`

```php

// CREATE FUNCTION

/**
* @param $string
*
* @return boolean
*/
public function isYoutubeLink($url) {
    if (false !== strpos($url, 'youtube')) {
        return true;
    }
    return false;
}


// RETURN IT IN:
// public function getFilters()

return [
    ...
    new \Twig_SimpleFilter('isYoutubeLink', [$this, 'isYoutubeLink']),
    ...
]
```

#### Usage
```php
{% if youtubeLink | isYoutubeLink %}
    some action
{% endif %}
```

[More informations](http://twig.sensiolabs.org/doc/2.x/advanced.html#creating-an-extension)